<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <title>YaYa Card Game</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2c7744">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="icon-192.png">

    <style>
        :root {
            --table-color: #2c7744;
            --card-width: 80px;
            --card-height: 120px;
        }

        body {
            font-family: 'Arial Rounded MT Bold', 'Helvetica Rounded', Arial, sans-serif;
            background-color: #1a1a1a;
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100dvh; 
            color: white;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
        }

        #game-board {
            flex-grow: 1;
            width: 100%;
            background-color: var(--table-color);
            background-image: radial-gradient(circle, #358f52 0%, #1e5230 100%);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            position: relative;
            
            border: 4px solid #1e5230;
            box-sizing: border-box;
            
            padding-bottom: env(safe-area-inset-bottom, 10px);
            margin-top: env(safe-area-inset-top, 0px);
            height: calc(100dvh - env(safe-area-inset-top, 0px));
            
            transition: border-color 0.5s;
        }

        /* --- ZONES --- */
        .cpu-area {
            width: 100%;
            height: 15%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 5px;
            flex-shrink: 0; 
        }

        .middle-section {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            
            justify-content: center;
            align-items: center;
            
            width: 100%;
            gap: 15px;
            min-height: 0;
            
            padding-top: 25px; 
            padding-bottom: 5px;
            
            position: relative; 
            margin-top: -5px;
        }

        .piles-row {
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
            gap: 30px;
            flex-shrink: 1; 
        }

        #game-log {
            width: 90%;
            max-width: 500px;
            height: 125px; 
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 8px;
            font-size: 0.85rem;
            border-radius: 8px;
            font-family: monospace;
            pointer-events: auto;
            text-align: left;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
            -webkit-overflow-scrolling: touch;
            margin-top: 5px;
            flex-shrink: 0; 
        }
        
        .log-entry { margin-bottom: 3px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 2px; }

        /* BUTTONS */
        .game-btn {
            pointer-events: auto;
            padding: 8px 20px;
            font-size: 1rem;
            border: 2px solid white;
            border-radius: 20px;
            font-weight: 900;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            text-transform: uppercase;
            transition: transform 0.1s;
        }
        .game-btn:active { transform: translateX(-50%) scale(0.95); }

        /* PLAY AGAIN: Positioned at -68px */
        #play-again-btn {
            position: absolute;
            bottom: -68px; 
            left: 50%;
            transform: translateX(-50%);
            
            background: #ffcc00; color: #333;
            display: none; 
            padding: 10px 30px; font-size: 1.1rem;
            z-index: 30;
        }
        #play-again-btn.visible {
            display: block;
            animation: popIn 0.3s ease-out;
        }

        /* INSTRUCTIONS: NOW also at -68px (Same as Play Again) */
        #instructions-btn {
            position: absolute;
            bottom: -68px; 
            left: 50%;
            transform: translateX(-50%);

            background: #0066ff; color: white;
            font-size: 0.9rem;
            padding: 6px 15px;
            z-index: 25;
        }

        @keyframes popIn {
            0% { transform: translateX(-50%) scale(0); opacity: 0; }
            80% { transform: translateX(-50%) scale(1.1); opacity: 1; }
            100% { transform: translateX(-50%) scale(1); }
        }

        .player-area {
            width: 100%;
            height: 35%;
            display: flex;
            align-items: center;
            padding: 10px 0;
            
            /* Margin set to 16px */
            margin-top: 16px;
            
            overflow-x: auto;
            justify-content: flex-start;
            gap: -10px;
            padding-left: 20px;
            padding-right: 20px;
            box-sizing: border-box;
            flex-shrink: 0;
        }
        .player-area::-webkit-scrollbar { display: none; }

        /* --- CARD DESIGN --- */
        .card {
            flex-shrink: 0;
            width: var(--card-width);
            height: var(--card-height);
            border-radius: 10px;
            box-shadow: -2px 2px 5px rgba(0,0,0,0.4);
            position: relative;
            cursor: pointer;
            transition: transform 0.2s;
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 4px solid white;
            box-sizing: border-box;
        }
        
        .card-inner {
            width: 100%; height: 100%;
            border-radius: 6px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        .oval {
            background: white;
            width: 90%; height: 60%;
            border-radius: 50% 50%;
            transform: rotate(-30deg);
            position: absolute;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.2);
        }

        .card-symbol {
            position: relative; z-index: 2;
            font-size: 2.5rem; font-weight: 900;
            text-shadow: 2px 2px 0px white, -1px -1px 0 white;
        }
        
        .corner-val {
            position: absolute; font-size: 0.8rem;
            font-weight: bold; color: white; padding: 2px;
        }
        .top-left { top: 2px; left: 4px; }
        .bot-right { bottom: 2px; right: 4px; transform: rotate(180deg); }

        .Red .card-inner { background: #ff5555; }
        .Red .card-symbol { color: #ff5555; }
        .Blue .card-inner { background: #0066ff; }
        .Blue .card-symbol { color: #0066ff; }
        .Green .card-inner { background: #55aa55; }
        .Green .card-symbol { color: #55aa55; }
        .Yellow .card-inner { background: #ffcc00; }
        .Yellow .card-symbol { color: #eebb00; }
        
        .Wild .card-inner, .wild4 .card-inner {
            background: conic-gradient(red, blue, green, yellow, red);
        }
        .Wild .card-symbol { color: black; text-shadow: 2px 2px 0 white; }

        .symbol-text { font-size: 1.2rem; transform: rotate(-15deg); }

        .card-back {
            background: linear-gradient(135deg, #000 25%, #222 25%, #222 50%, #000 50%, #000 75%, #222 75%, #222 100%);
            background-size: 20px 20px;
            width: 100%; height: 100%;
            border-radius: 8px;
            display: flex; justify-content: center; align-items: center;
            border: 2px solid white;
        }
        .back-oval {
            background: #ff5555; color: yellow; font-weight: bold;
            padding: 5px 2px; width: 80%; text-align: center;
            border-radius: 50%; transform: rotate(-25deg);
            border: 2px solid white; font-size: 1.1rem;
            text-shadow: 1px 1px 0 #aa0000;
        }

        .player-area .card:active { transform: scale(0.95); }
        .card.disabled { filter: brightness(0.6); opacity: 0.8; }
        
        #turn-indicator {
            font-size: 1.2rem; font-weight: bold; 
            background: rgba(0,0,0,0.5);
            padding: 5px 15px; border-radius: 20px; 
            margin-bottom: 5px; text-transform: uppercase;
        }

        /* MODAL & PICKER */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); display: none;
            justify-content: center; align-items: center; z-index: 200;
        }
        .picker-content { background: white; padding: 20px; border-radius: 15px; text-align: center; }
        .color-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px; }
        .color-btn { width: 60px; height: 60px; border-radius: 10px; border: none; }

        /* INSTRUCTIONS SPECIFIC */
        #instructions-modal .modal-content {
            background: #fff;
            width: 90%; max-width: 400px;
            max-height: 80%;
            border-radius: 15px;
            padding: 20px;
            color: #333;
            overflow-y: auto;
            text-align: left;
            position: relative;
        }
        .close-btn {
            position: absolute; top: 10px; right: 15px;
            font-size: 1.5rem; font-weight: bold;
            cursor: pointer; color: #666;
        }
        .stat-box {
            background: #eee; padding: 10px;
            border-radius: 8px; margin-bottom: 15px;
            font-family: monospace; font-size: 1rem;
            text-align: center; border: 1px solid #ccc;
        }
        .card-row {
            display: flex; align-items: center; gap: 15px;
            margin-bottom: 10px; border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        .sample-card-wrapper { transform: scale(0.5); transform-origin: left center; width: 40px; height: 60px; }
        .card-desc { font-size: 0.9rem; line-height: 1.3; }
        .card-desc strong { color: #2c7744; }

        @media (max-width: 600px) {
            :root { --card-width: 65px; --card-height: 96px; }
            .piles-row { gap: 15px; }
        }
    </style>
</head>
<body>

    <div id="game-board">
        <div class="cpu-area" id="cpu-hand"></div>
        
        <div class="middle-section">
            <div id="turn-indicator">Loading...</div>
            <div class="piles-row">
                <div class="card" id="draw-deck" onclick="humanDraw()">
                    <div class="card-back"><div class="back-oval">YaYa</div></div>
                </div>
                <div id="discard-pile-container"></div>
            </div>
            
            <div id="game-log"></div>

            <button id="instructions-btn" class="game-btn" onclick="openInstructions()">How to Play</button>
            <button id="play-again-btn" class="game-btn" onclick="initGame()">Play Again</button>
        </div>

        <div class="player-area" id="player-hand"></div>
    </div>

    <div id="color-picker" class="modal-overlay">
        <div class="picker-content">
            <h2 style="color:black; margin:0;">Pick Color</h2>
            <div class="color-grid">
                <button class="color-btn" style="background:#ff5555" onclick="resolveWild('Red')"></button>
                <button class="color-btn" style="background:#0066ff" onclick="resolveWild('Blue')"></button>
                <button class="color-btn" style="background:#55aa55" onclick="resolveWild('Green')"></button>
                <button class="color-btn" style="background:#ffcc00" onclick="resolveWild('Yellow')"></button>
            </div>
        </div>
    </div>

    <div id="instructions-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="close-btn" onclick="closeInstructions()">×</div>
            <h2 style="margin-top:0; text-align:center;">YaYa       v1.17</h2>
            
            <div class="stat-box" id="stat-display">
                Loading Stats...
            </div>
            
            <p style="font-size:0.9rem; margin-bottom:15px;">
                <strong>Objective:</strong> Be the first to empty your hand. Match the top card by color or symbol.
            </p>

   <div style="text-align:center; margin-bottom:8px;">
                <a href="https://www.buymeacoffee.com/classmarks" target="_blank" style="text-decoration:none;">
                    <button style="font-size:0.8rem; padding:8px 15px; border-radius:20px; border:none; font-weight:bold; cursor:pointer; background:#FFDD00; color:#000000; box-shadow:0 3px #c2a900;">☕ Buy Me A Coffee</button>
                </a>
            </div>

            <h3 style="border-bottom:2px solid #2c7744; padding-bottom:5px;">Special Cards</h3>
            
            <div id="legend-container"></div>
        </div>
    </div>

<script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('./sw.js')
                .then(req => console.log('Service Worker Registered!'))
                .catch(err => console.log('Service Worker Failed', err));
        });
    }

    const COLORS = ['Red', 'Blue', 'Green', 'Yellow'];
    let deck = [], discardPile = [], playerHand = [], cpuHand = [];
    let currentColor = '', currentSymbol = '', isPlayerTurn = true, gameActive = true, hasDrawnThisTurn = false; 
    let firstCardPlayed = false;

    // Stats
    let stats = { wins: 0, losses: 0 };

    const logEl = document.getElementById('game-log');
    const turnEl = document.getElementById('turn-indicator');
    const discardContainer = document.getElementById('discard-pile-container');
    const playAgainBtn = document.getElementById('play-again-btn');
    const instructionsBtn = document.getElementById('instructions-btn');

    function initGame() {
        deck = []; discardPile = []; playerHand = []; cpuHand = [];
        currentColor = ''; currentSymbol = '';
        isPlayerTurn = true; gameActive = true; hasDrawnThisTurn = false;
        firstCardPlayed = false;

        loadStats();
        
        logEl.innerHTML = '';
        
        playAgainBtn.classList.remove('visible');
        instructionsBtn.style.display = 'block';
        
        turnEl.style.color = 'white';
        
        createDeck();
        shuffleDeck();
        dealCards();
        
        let firstCard = drawFromDeck();
        while (firstCard.type === 'wild' || firstCard.type === 'wild4') {
            deck.push(firstCard);
            shuffleDeck();
            firstCard = drawFromDeck();
        }
        
        playCardToPile(firstCard, false);
        renderGame();
        log("Welcome to YaYa!");
        updateTurnIndicator();

        buildLegend();
    }

    function loadStats() {
        const storedWins = localStorage.getItem('yaya_wins');
        const storedLosses = localStorage.getItem('yaya_losses');
        if (storedWins) stats.wins = parseInt(storedWins);
        if (storedLosses) stats.losses = parseInt(storedLosses);
    }

    function saveStats() {
        localStorage.setItem('yaya_wins', stats.wins);
        localStorage.setItem('yaya_losses', stats.losses);
    }

    function openInstructions() {
        document.getElementById('stat-display').innerText = 
            `Stats: Wins/Losses = ${stats.wins}/${stats.losses}`;
        
        document.getElementById('instructions-modal').style.display = 'flex';
    }

    function closeInstructions() {
        document.getElementById('instructions-modal').style.display = 'none';
    }

    function buildLegend() {
        const container = document.getElementById('legend-container');
        if (container.innerHTML !== '') return; // Already built

        const definitions = [
            { c: createCard('Blue', 'Skip', 'action'), text: "<strong>Skip:</strong> Next player loses their turn. In 2-player, you play again immediately." },
            { c: createCard('Green', 'Reverse', 'action'), text: "<strong>Reverse:</strong> Switches direction. In 2-player, acts exactly like a Skip (you play again)." },
            { c: createCard('Red', 'Draw2', 'action'), text: "<strong>Draw 2:</strong> Next player draws 2 cards and loses their turn." },
            { c: createCard('Wild', 'Wild', 'wild'), text: "<strong>Wild:</strong> Change the active color to one of your choice. Playable on any card." },
            { c: createCard('Wild', 'Draw4', 'wild4'), text: "<strong>Wild Draw 4:</strong> Change color, next player draws 4 cards and loses turn. Playable on any card." },
             { c: createCard('Yellow', '5', 'number'), text: "<strong>Number Cards (1-9):</strong> Standard cards. Match by color or number to play." }
        ];

        definitions.forEach(item => {
            const row = document.createElement('div');
            row.className = 'card-row';
            
            const wrapper = document.createElement('div');
            wrapper.className = 'sample-card-wrapper';
            wrapper.appendChild(renderCardHTML(item.c, false));
            
            const desc = document.createElement('div');
            desc.className = 'card-desc';
            desc.innerHTML = item.text;

            row.appendChild(wrapper);
            row.appendChild(desc);
            container.appendChild(row);
        });
    }

    function createDeck() {
        deck = [];
        COLORS.forEach(color => {
            deck.push(createCard(color, '0', 'number'));
            for (let i = 1; i <= 9; i++) {
                deck.push(createCard(color, i.toString(), 'number'));
                deck.push(createCard(color, i.toString(), 'number'));
            }
            ['Skip', 'Reverse', 'Draw2'].forEach(type => {
                deck.push(createCard(color, type, 'action'));
                deck.push(createCard(color, type, 'action'));
            });
        });
        for(let i=0; i<4; i++) {
            deck.push(createCard('Wild', 'Wild', 'wild'));
            deck.push(createCard('Wild', 'Draw4', 'wild4'));
        }
    }

    function createCard(color, value, type) {
        return {
            id: Math.random().toString(36).substr(2, 9),
            color: color, value: value, type: type
        };
    }

    function shuffleDeck() {
        for (let i = deck.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [deck[i], deck[j]] = [deck[j], deck[i]];
        }
    }

    function drawFromDeck() {
        if (deck.length === 0) {
            if (discardPile.length > 1) {
                const topCard = discardPile.pop();
                deck = discardPile;
                discardPile = [topCard];
                shuffleDeck();
                log("Shuffling...");
            } else {
                log("Empty Deck!");
                return null;
            }
        }
        return deck.pop();
    }

    function dealCards() {
        for(let i=0; i<7; i++) {
            playerHand.push(drawFromDeck());
            cpuHand.push(drawFromDeck());
        }
    }

    function isPlayable(card) {
        if (card.type === 'wild' || card.type === 'wild4') return true;
        if (card.color === currentColor) return true;
        if (card.value === currentSymbol) return true;
        return false;
    }

    function playCardToPile(card, triggerEffects = true) {
        discardPile.push(card);
        currentColor = card.color;
        currentSymbol = card.value;
        
        discardContainer.innerHTML = '';
        discardContainer.appendChild(renderCardHTML(card, false));

        if (triggerEffects) {
            handleSpecialEffects(card);
        }
    }

    function renderCardHTML(card, isClickable = true) {
        const el = document.createElement('div');
        el.className = `card ${card.color} ${card.type}`;
        
        let displayVal = card.value;
        let isSymbol = false;

        if(card.value === 'Draw2') { displayVal = '+2'; isSymbol=true; }
        if(card.value === 'Draw4') { displayVal = '+4'; isSymbol=true; }
        if(card.value === 'Skip') { displayVal = '⊘'; isSymbol=true; }
        if(card.value === 'Reverse') { displayVal = '⇄'; isSymbol=true; }
        if(card.value === 'Wild') { displayVal = '?'; isSymbol=true; }
        
        const innerClass = isSymbol ? 'card-symbol symbol-text' : 'card-symbol';

        el.innerHTML = `
            <div class="card-inner">
                <div class="oval"></div>
                <div class="${innerClass}">${displayVal}</div>
                <div class="corner-val top-left">${displayVal}</div>
                <div class="corner-val bot-right">${displayVal}</div>
            </div>
        `;
        return el;
    }

    function handleSpecialEffects(card) {
        if (playerHand.length === 0 || cpuHand.length === 0) {
            setTimeout(checkWinCondition, 200);
            return;
        }

        let extraTurn = false;
        if (card.value === 'Skip' || card.value === 'Reverse') {
            log(`${isPlayerTurn ? 'You' : 'CPU'} Skip!`);
            extraTurn = true;
        }
        else if (card.value === 'Draw2') {
            const targetHand = isPlayerTurn ? cpuHand : playerHand;
            targetHand.push(drawFromDeck());
            targetHand.push(drawFromDeck());
            renderGame();
            log("Draw 2 + Skip.");
            extraTurn = true;
        }
        else if (card.type === 'wild' || card.type === 'wild4') {
            gameActive = false;
            if (isPlayerTurn) {
                document.getElementById('color-picker').style.display = 'flex';
            } else {
                resolveWild(getCpuBestColor());
            }
            return;
        }

        if (extraTurn) {
            hasDrawnThisTurn = false;
            updateTurnIndicator();
            if (!isPlayerTurn && gameActive) setTimeout(cpuTurn, 1500);
            return;
        }
        switchTurn();
    }

    function resolveWild(color) {
        currentColor = color;
        log(`Color: ${color}`);
        document.getElementById('color-picker').style.display = 'none';
        
        const topEl = discardContainer.firstElementChild;
        if(topEl) {
            topEl.className = `card ${color}`;
        }

        const topCard = discardPile[discardPile.length - 1];
        if (topCard.type === 'wild4') {
            if (playerHand.length === 0 || cpuHand.length === 0) {
                setTimeout(checkWinCondition, 200);
                return;
            }

            const targetHand = isPlayerTurn ? cpuHand : playerHand;
            for(let i=0; i<4; i++) targetHand.push(drawFromDeck());
            log("Draw 4 + Skip!");
            renderGame();
            
            gameActive = true;
            hasDrawnThisTurn = false;
            updateTurnIndicator();
            if (!isPlayerTurn && gameActive) setTimeout(cpuTurn, 1500);
            return; 
        }
        gameActive = true;
        switchTurn();
    }

    function switchTurn() {
        if(!gameActive) return;
        isPlayerTurn = !isPlayerTurn;
        hasDrawnThisTurn = false;
        updateTurnIndicator();
        renderGame();
        if (!isPlayerTurn) setTimeout(cpuTurn, 1500);
    }

    function checkWinCondition() {
        if (playerHand.length === 0) {
            endGame(true);
        } else if (cpuHand.length === 0) {
            endGame(false);
        }
    }

    function endGame(playerWon) {
        gameActive = false;
        
        if (playerWon) {
            stats.wins++;
            log("Player wins!!");
            turnEl.innerText = "Player wins!!";
        } else {
            stats.losses++;
            log("CPU won!!");
            turnEl.innerText = "CPU won!!";
        }
        saveStats();

        turnEl.style.color = '#ffcc00'; 
        
        playAgainBtn.classList.add('visible');
    }

    function humanPlayCard(index) {
        if (!isPlayerTurn || !gameActive) return;
        
        if (!firstCardPlayed) {
            firstCardPlayed = true;
            instructionsBtn.style.display = 'none';
        }

        const card = playerHand[index];
        if (isPlayable(card)) {
            playerHand.splice(index, 1);
            playCardToPile(card);
            renderGame();
        } else log("Can't play that.");
    }

    function humanDraw() {
        if (!isPlayerTurn || !gameActive) return;
        if (hasDrawnThisTurn) { switchTurn(); return; }

        const newCard = drawFromDeck();
        if (newCard) {
            playerHand.push(newCard);
            renderGame();
            const pHand = document.getElementById('player-hand');
            pHand.scrollLeft = pHand.scrollWidth;

            if (isPlayable(newCard)) {
                log("Drew playable card.");
                hasDrawnThisTurn = true;
                updateTurnIndicator();
            } else {
                log("Drew card. No moves.");
                setTimeout(switchTurn, 1000);
            }
        }
    }

    function cpuTurn() {
        if (!gameActive) return;
        const playable = cpuHand.filter(c => isPlayable(c));
        if (playable.length > 0) playCpuBestOption(playable);
        else {
            const newCard = drawFromDeck();
            if(newCard) {
                cpuHand.push(newCard);
                if (isPlayable(newCard)) {
                    log("CPU plays drawn card!");
                    setTimeout(() => playCpuBestOption([newCard]), 1000);
                } else {
                    log("CPU Passes");
                    setTimeout(switchTurn, 1000);
                }
            } else setTimeout(switchTurn, 1000);
        }
    }

    function playCpuBestOption(playable) {
        playable.sort((a,b) => (a.type === 'action' || a.type === 'wild4') ? -1 : 0);
        const chosen = playable[0];
        cpuHand.splice(cpuHand.indexOf(chosen), 1);
        renderGame();
        playCardToPile(chosen);
    }

    function getCpuBestColor() {
        const counts = { Red:0, Blue:0, Green:0, Yellow:0 };
        cpuHand.forEach(c => { if (COLORS.includes(c.color)) counts[c.color]++; });
        return Object.keys(counts).reduce((a, b) => counts[a] > counts[b] ? a : b);
    }

    function renderGame() {
        const pHandEl = document.getElementById('player-hand');
        const cHandEl = document.getElementById('cpu-hand');
        
        pHandEl.innerHTML = '';
        playerHand.forEach((card, index) => {
            const el = renderCardHTML(card);
            if (isPlayerTurn && !isPlayable(card)) el.classList.add('disabled');
            el.onclick = () => humanPlayCard(index);
            pHandEl.appendChild(el);
        });

        cHandEl.innerHTML = '';
        cpuHand.forEach(() => {
            const el = document.createElement('div');
            el.className = 'card';
            el.style.transform = 'scale(0.8)';
            el.innerHTML = `<div class="card-back"><div class="back-oval">YaYa</div></div>`;
            cHandEl.appendChild(el);
        });
        
        if (isPlayerTurn && hasDrawnThisTurn) turnEl.innerText = "Play or Pass";
    }

    function updateTurnIndicator() {
        if (!gameActive) return;
        
        if (!hasDrawnThisTurn) turnEl.innerText = isPlayerTurn ? "Your Turn" : "CPU Turn";
        turnEl.style.color = isPlayerTurn ? "#44ff44" : "#ff4444";
        
        const board = document.getElementById('game-board');
        const borderColor = 
            currentColor === 'Red' ? '#aa0000' :
            currentColor === 'Blue' ? '#0000aa' :
            currentColor === 'Green' ? '#00aa00' :
            currentColor === 'Yellow' ? '#aaaa00' : '#2c7744';
            
        board.style.borderColor = borderColor;
    }

    function log(msg) {
        const div = document.createElement('div');
        div.className = 'log-entry';
        div.innerText = `> ${msg}`;
        logEl.appendChild(div);
        logEl.scrollTop = logEl.scrollHeight;
    }

    window.onload = initGame;
</script>
</body>
</html>
